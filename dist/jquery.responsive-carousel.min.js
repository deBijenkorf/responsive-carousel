/** 
 * Responsive carousel - v0.1.0 - 2015-04-23
 * https://github.com/debijenkorf/responsive-carousel
 * Copyright (c) 2015 De Bijenkorf 
 * Licensed MIT, GPL 
 */


var DBK=window.DBK||{};DBK.render=function(a,b,c){if("object"!=typeof DBK.render||"undefined"==typeof DBK.render.LOADED){var d=a,e=function(a){for(var b=a,e=b.charAt(0).toUpperCase()+b.slice(1),f=0;f<d.length&&!c.body.style[b];++f)if("undefined"!=typeof c.body.style[d[f]+e])return d[f]+e;return b};return{vendorPropertyName:e,LOADED:!0}}}(window.Modernizr._domPrefixes,window,document),function(a,b,c,d,e,f){function g(a,b){this.element=a,this.$element=c(a),this.options=c.extend({},i,b),this.init()}var h="carousel",i={ctrlBtnPrev:".dbk-carousel-control-btn_previous",ctrlBtnNext:".dbk-carousel-control-btn_next",carouselUl:".dbk-carousel-wrapper > ul",populateImagesAfterEvent:!1};g.prototype={init:function(){this.$element.get(0)&&(this.$ul=this.$element.find(this.options.carouselUl),this.ul=this.$ul.get(0),this.ul.children.length<1||(this.$ctrlBtnPrev=this.$element.find(this.options.ctrlBtnPrev),this.$ctrlBtnNext=this.$element.find(this.options.ctrlBtnNext),this.transformProperty=a.vendorPropertyName("transform"),this.transitionendProperty=a.vendorPropertyName("transitionend"),this.swipeThreshold=5,this.timeConstant=325,this.populateImagesAfterEvent=this.options.populateImagesAfterEvent,this.initProperties(),this.renderInterface(),this.bindEvents(),this.toggleVisibility(this.$element.parents(".dbk-row.clearfix")),this.$element.trigger("carousel:initialized",[this.ul,this.$ul])))},initProperties:function(){this.liWidth=this.ul.children[0].offsetWidth,this.liCount=this.ul.children.length,this.ulWidth=this.liWidth*this.liCount,this.maxLiItems=Math.floor(this.ul.parentElement.offsetWidth/this.liWidth),this.wrapperWidth=this.maxLiItems*this.liWidth,this.xPosition=0,this.rasterPosition=0,this.deltaLiCount=this.liCount%this.maxLiItems,this.deltaEvent=0===this.deltaLiCount?!1:!0,this.currentCycle=1,this.touchCoordX="undefined",this.moved=!1,this.cancelKinetic=!1},renderInterface:function(){var a={width:this.ulWidth,height:"auto"};this.liCount<=this.maxLiItems?a={width:this.ulWidth,height:"auto","float":"none",margin:"0 auto"}:(this.toggleVisibility(this.$ctrlBtnPrev),this.toggleVisibility(this.$ctrlBtnNext)),this.$ul.css(a),this.$ul.parent().css({width:this.wrapperWidth}),this.updateCtrlStatus()},bindEvents:function(){this.toggleCtrlEvent(this.$ctrlBtnPrev,"prev"),this.toggleCtrlEvent(this.$ctrlBtnNext,"next"),b.touch&&(this.$ul.on("touchstart.carousel",c.proxy(this.setXPosition,this)),this.$ul.on("touchmove.carousel",c.proxy(this.translateTouch,this)),this.$ul.on("touchend.carousel",c.proxy(this.touchend,this)),this.$ul.on(this.transitionendProperty+".carousel",c.proxy(this.transitionend,this))),c(e).on("smartresize.carousel",c.proxy(this.reset,this))},toggleCtrlEvent:function(a,b){var d=a,e=b;d.hasClass("fade")&&!d.hasClass("in")&&d.off("click.carousel"),d.hasClass("fade")&&d.hasClass("in")&&("prev"==e&&d.on("click.carousel",c.proxy(this.prev,this)),"next"==e&&d.on("click.carousel",c.proxy(this.next,this)))},toggleVisibility:function(a){var b=a;b.hasClass("fade")&&!b.hasClass("in")&&b.addClass("in")},triggerUpdateEvent:function(){this.populateImagesAfterEvent&&(this.$element.trigger("carousel:update",[this.ul,this.$ul]),this.populateImagesAfterEvent=!1)},updateCtrlStatus:function(){-this.ulWidth<this.xPosition&&(this.$ctrlBtnPrev.removeClass("disabled"),this.$ctrlBtnNext.removeClass("disabled")),0===this.xPosition&&this.$ctrlBtnPrev.addClass("disabled"),-this.ulWidth==this.xPosition-this.maxLiItems*this.liWidth&&this.$ctrlBtnNext.addClass("disabled")},toggleDelayClass:function(a){this.$ul.hasClass("no-delay")||"touchmove"!=a||this.$ul.addClass("no-delay"),!this.$ul.hasClass("no-delay")||"click"!=a&&"touchend"!=a||this.$ul.removeClass("no-delay")},touchend:function(a){if(a.preventDefault(),!this.moved)return void a.target.click();this.$ul.addClass("no-delay");var b,c=this.xPosition;clearInterval(this.ticker),this.velocity>1e3||this.velocity<-1e3?(this.amplitude=.8*(this.velocity/5),b=Math.round(a.originalEvent.changedTouches[0].pageX+this.amplitude),this.timestamp=Date.now(),this.autoTranslate(b,c)):this.snapToGrid()},snapToGrid:function(){return this.rasterPosition=Math.round(this.xPosition/this.liWidth),this.currentCycle=Math.floor((-this.rasterPosition+this.maxLiItems)/this.maxLiItems),this.$ul.removeClass("no-delay"),this.xPosition>0||this.liCount<this.maxLiItems?(this.reset(),void this.translate("touch",0)):this.xPosition<-this.ulWidth+this.wrapperWidth?(this.rasterPosition=-this.liCount,void this.translate("touch",-this.ulWidth+this.wrapperWidth)):void this.translate("touch",this.rasterPosition*this.liWidth)},setXPosition:function(a){a.preventDefault(),this.velocity=this.amplitude=0,this.frame=a.originalEvent.changedTouches[0].pageX,this.timestamp=Date.now(),clearInterval(this.ticker),this.ticker=setInterval(this.calculateVelocity,100),this.moved=!1,this.touchCoordX=a.originalEvent.changedTouches[0].pageX-this.xPosition,this.triggerUpdateEvent()},autoTranslate:function(a,b,e){var f,g,h,i=a,j=b;return this.cancelKinetic?void(g=0):void(this.amplitude&&(f=Date.now()-this.timestamp,g=-this.amplitude*Math.exp(-f/this.timeConstant),h=isNaN(e)?0:g-e,(this.xPosition<-this.ulWidth+this.wrapperWidth-this.liWidth||this.xPosition>this.liWidth)&&(g=0),g>.6||-.6>g?(this.translate("kinetic",h),d.requestAnimationFrame(c.proxy(function(){this.autoTranslate(i,j,g)},this))):this.snapToGrid()))},calculateVelocity:function(a){var b,c,d,e,f=a;b=Date.now(),c=b-this.timestamp,this.timestamp=b,d=f-this.frame,this.frame=f,e=1e3*d/(1+c),this.velocity=.8*e+.2*this.velocity},translateTouch:function(a){this.toggleDelayClass(a.type);var b=-(this.touchCoordX-a.originalEvent.changedTouches[0].pageX);this.calculateVelocity(a.originalEvent.changedTouches[0].pageX),(b>this.swipeThreshold||b<-this.swipeThreshold)&&(a.preventDefault(),this.cancelKinetic=!1,this.moved=!0,this.translate("touch",b))},translate:function(a,c){var d="undefined"!=typeof c?c:this.wrapperWidth;"previous"==a||"kinetic"==a?this.xPosition+=d:"next"==a?this.xPosition-=d:"touch"==a&&(this.xPosition=d),b.csstransforms3d?this.$ul.css(this.transformProperty,"translate3d("+this.xPosition+"px, 0 ,0)"):this.$ul.animate({left:this.xPosition+"px"}),this.updateCtrlStatus()},transitionend:function(a){a.preventDefault(),a.stopPropagation(),a.target==this.ul&&(this.snapToGrid(),this.cancelKinetic=!1)},getControlProperties:function(a){var b=a;return this.rasterPosition=Math.round(this.xPosition/this.liWidth),this.currentCycle=Math.floor((-this.rasterPosition+this.maxLiItems)/this.maxLiItems),this.deltaLiCount=(this.liCount+this.rasterPosition)%this.maxLiItems,"previous"==b?void(-this.rasterPosition<this.maxLiItems?this.deltaEvent=!0:this.deltaEvent=!1):void("next"==b&&(this.liCount-(-this.rasterPosition+this.maxLiItems)<this.maxLiItems?this.deltaEvent=!0:this.deltaEvent=!1))},prev:function(a){if(a.preventDefault(),this.cancelKinetic=!0,this.toggleDelayClass(a.type),this.getControlProperties("previous"),0!==this.xPosition){if(!this.deltaEvent)return this.translate("previous"),void this.currentCycle--;this.translate("previous",this.deltaLiCount*this.liWidth),this.reset(),this.updateCtrlStatus()}},next:function(a){return a.preventDefault(),this.cancelKinetic=!0,this.toggleDelayClass(a.type),this.getControlProperties("next"),this.xPosition!=-this.ulWidth+this.wrapperWidth?(this.triggerUpdateEvent(),this.deltaEvent?void this.translate("next",this.deltaLiCount*this.liWidth):(this.translate("next"),void this.currentCycle++)):void 0},removeAttributes:function(){this.ul.parentElement.removeAttribute("style"),this.ul.removeAttribute("style"),this.ul.removeAttribute("class"),this.$ctrlBtnPrev.removeClass("in"),this.$ctrlBtnNext.removeClass("in")},reset:function(){this.removeAttributes(),this.initProperties(),this.renderInterface()},destroy:function(){this.removeAttributes(),this.toggleCtrlEvent(this.$ctrlBtnPrev),this.toggleCtrlEvent(this.$ctrlBtnNext),b.touch&&(this.$ul.off("touchstart.carousel"),this.$ul.off("touchmove.carousel"),this.$ul.off("touchend.carousel"),this.$ul.off(this.transitionendProperty+".carousel")),c(e).off("smartresize.carousel")}},c.fn[h]=function(a){var b=arguments;if(a===f||"object"==typeof a)return this.each(function(){c.data(this,"plugin_"+h)||c.data(this,"plugin_"+h,new g(this,a))});if("string"==typeof a&&"_"!==a[0]&&"init"!==a){var d;this.each(function(){var e=c.data(this,"plugin_"+h);return e instanceof g&&"function"==typeof e[a]&&(d=e[a].apply(e,Array.prototype.slice.call(b,1))),"destroy"===a&&c.data(this,"plugin_"+h,null),d!==f?d:this})}}}(DBK.render,window.Modernizr,jQuery,window,document);